---
- hosts: all
  become: yes
  tasks:
    - name: Update apt
      apt:
        update_cache: yes
    - name: Install LFC Host Dependencies
      apt:
        name: "{{ item }}"
        update_cache: no
      with_items:
        - bison
        - binutils
        - bzip2
        - coreutils
        - diffutils
        - findutils
        - gawk
        - build-essential
        - gzip
        - texinfo
    - name: Symlink sh to bash
      file:
        path: /bin/sh
        src: /bin/bash
        state: link
    - name: Run Verification Script
      script: /home/vagrant/scripts/version-check.sh
    - name: Create Mnt Directory for LFC
      file:
        path: /mnt/lfs
        state: directory
    - name: Set up /dev/sdb1 mount
      mount:
        src: /dev/sdb1
        path: /mnt/lfs
        fstype: ext4
        boot: yes
        state: present
    - name: Set up symlink in vagrant home to /mnt/lfs
      file:
        path: /home/vagrant/lfs
        src: /mnt/lfs
        state: link
